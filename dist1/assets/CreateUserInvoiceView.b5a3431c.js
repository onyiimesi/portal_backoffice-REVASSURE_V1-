import{H as D}from"./Header.747f91be.js";import{_ as k,a as d,o as a,c as n,b as e,k as I,t as l,l as u,n as g,v,F as h,j as p,e as C,d as f,f as b,h as y,r as z}from"./index.06a914a2.js";const N={name:"customeruserinvoice",data(){return{errors:[],message:[],allitem:[],allitems:[],invoicesubtotal:0,invoicetotal:0,invoicetax:0,tax:[],price:[],allorg:[],allsub:[],allcurrency:[],customerDetails:{customerCode:"",fullNames:"",id:"",fullNames:""},orgDetails:{emailAddress:"",subOrganisationCode:"",organizationCode:"",firstName:"",lastName:"",middleName:"",gender:"",unit:""},organisationCode:"",subOrganisationCode:"",customerCode:"",currencyCode:"",itemList:[],items:[{itemCode:"",quantity:"",line_total:0,allitems:""}]}},async mounted(){const i=await d.get("api/Users/profile",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.orgDetails=i.data.result;const s=await d.get("api/Customer/details/"+this.$route.params.id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.customerDetails=s.data.result;const c=await d.get("api/Currency/allcurrencies",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allcurrency=c.data.result;const _=await d.get("api/Item/organizations/"+this.orgDetails.organizationCode,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allitem=_.data.result;const t=await d.get("api/Organisation/details/"+this.orgDetails.organizationCode,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allorg=t.data.result},methods:{calculateTotal(){var i,s;i=this.items.reduce(function(c,_){var t=parseFloat(_.line_total);if(!isNaN(t))return c+t},0),this.invoicesubtotal=i.toFixed(2),s=i*(this.allitems.taxType/100)+i,s=parseFloat(s),isNaN(s)?this.invoicetotal="0.00":this.invoicetotal=s.toFixed(2)},calculateLineTotal(i){var s=parseFloat(this.allitems.price)*parseFloat(i.quantity);isNaN(s)||(i.line_total=s.toFixed(2)),this.calculateTotal()},deleteRow(i,s){var c=this.items.indexOf(s);console.log(c,i),c>-1&&this.items.splice(c,1),this.calculateTotal()},async onChange(i){const s=await d.get("api/Item/details/"+i.target.value,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allitems=s.data.result,this.items.push({itemCode:"",quantity:"",line_total:0})},async createInvoice(){this.errors=[],this.message=[],this.itemList.push(this.items);const i=await d.post("api/Invoice/addinvoice",{organisationCode:this.organisationCode,subOrganisationCode:this.orgDetails.subOrganisationCode,customerCode:this.customerDetails.customerCode,currencyCode:this.currencyCode,items:this.items},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log(i),i?(this.message.push(i.data.message),this.currencyCode="",this.items={},this.invoicesubtotal="",this.invoicetotal="",this.allitems=""):this.errors.push("Incorrect Parameter")}}},V={id:"layout-wrapper"},S={class:"main-content"},A={class:"page-content"},B={class:"container-fluid"},T=b('<div class="row"><div class="col-12"><div class="page-title-box d-flex align-items-center justify-content-between"><h4 class="mb-0">Create Customer Invoice</h4><div class="page-title-right"><ol class="breadcrumb m-0"><li class="breadcrumb-item"><a href="javascript: void(0);">Back Office</a></li><li class="breadcrumb-item active">Create Customer Invoice</li></ol></div></div></div></div>',1),U={class:"row"},O={class:"col-lg-12"},w={class:"row"},F={class:"col-md-6 m-0 p-0"},q={class:"bg-white p-4 h-100"},L={class:""},P={class:"mb-4"},j={class:"mb-3"},M={style:{"font-size":"18px"}},R={class:"mb-3"},E={style:{"font-size":"18px"}},H={class:"mb-3"},K={style:{"font-size":"18px"}},G={class:"col-md-6 p-0"},Q={class:"bg-white p-4"},J={class:""},W=b('<div class="form-group"><label for="">Invoice Date</label><input type="date" class="form-control"></div><div class="form-group"><label for="">Due Date</label><input type="date" class="form-control"></div>',2),X={class:"form-group"},Y=e("label",{class:"control-label"},"Currency Code",-1),Z=["value"],$=["value"],ee=["value"],te={class:"bg-white p-4 mb-4 w-100"},se={class:""},oe={class:""},ie={class:""},le=["value"],ae={class:"col-md-12"},ne={class:"form-group"},re={class:""},ce={class:""},de={class:"row"},ue={class:"col-md-12"},me={key:0,class:"alert alert-danger"},he=e("b",null,"Please correct the following error(s):",-1),_e={key:1,class:"alert alert-success"},ve={class:"table table-bordered text-center"},pe=e("thead",{class:"bg-dark text-white"},[e("td",null,"Item Name & Price"),e("td",null,"Quantity"),e("td",null,"Amount"),e("td")],-1),ge=["onUpdate:modelValue"],fe=e("option",null,"Choose",-1),be=["value"],ye=["onUpdate:modelValue","onKeyup"],Ce=["onClick"],xe=e("i",{class:"fa fa-times"},null,-1),De=[xe],ke=e("hr",null,null,-1),Ie={class:"card-body"},ze={class:"row"},Ne=e("div",{class:"col-md-6"},null,-1),Ve={class:"col-md-6"},Se={class:"text-right"},Ae={style:{"font-size":"16px"}},Be=y("Subtotal: "),Te={style:{"font-size":"16px"}},Ue=y("VAT: "),Oe={class:"mt-4"},we={style:{"font-size":"16px"}},Fe=y("Grand Total: "),qe=e("button",{class:"btn btn-success mt-3 mr-4"},"Submit",-1),Le=b('<footer class="footer"><div class="container-fluid"><div class="row"><div class="col-sm-6"> BackOffice 0.1 \xA9 2022 </div><div class="col-sm-6"><div class="text-sm-right d-none d-sm-block"> Powered by Intelligence </div></div></div></div></footer>',1);function Pe(i,s,c,_,t,m){const x=z("router-view");return a(),n(h,null,[e("div",V,[e("div",S,[e("div",A,[e("div",B,[T,e("div",U,[e("form",{onSubmit:s[6]||(s[6]=I((...o)=>m.createInvoice&&m.createInvoice(...o),["prevent"])),class:"w-100"},[e("div",O,[e("div",w,[e("div",F,[e("div",q,[e("div",L,[e("div",P,[e("h3",null,l(t.customerDetails.firstname)+" "+l(t.customerDetails.lastname),1)]),e("div",j,[e("p",M,l(t.customerDetails.contactAddress),1)]),e("div",R,[e("p",E,l(t.customerDetails.customerCode),1)]),e("div",H,[e("p",K,l(t.customerDetails.mobileNumber1)+" - "+l(t.customerDetails.emailAddress),1)])])])]),e("div",G,[e("div",Q,[e("div",J,[W,e("div",X,[Y,u(e("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.currencyCode=o),class:"form-control"},[e("option",{value:this.allcurrency[0]},l(this.allcurrency[0]),9,Z),e("option",{value:this.allcurrency[1]},l(this.allcurrency[1]),9,$),e("option",{value:this.allcurrency[2]},l(this.allcurrency[2]),9,ee)],512),[[g,t.currencyCode]])])])])])])]),e("div",te,[e("div",se,[e("div",oe,[e("div",ie,[u(e("input",{class:"form-control",readonly:"",type:"hidden","onUpdate:modelValue":s[1]||(s[1]=o=>t.orgDetails.organizationCode=o)},null,512),[[v,t.orgDetails.organizationCode]]),u(e("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.organisationCode=o),class:"form-control"},[e("option",{value:t.orgDetails.organizationCode},l(t.orgDetails.organizationCode),9,le)],512),[[g,t.organisationCode]])])]),e("div",ae,[e("div",ne,[u(e("input",{class:"form-control",readonly:"",type:"hidden","onUpdate:modelValue":s[3]||(s[3]=o=>t.orgDetails.subOrganisationCode=o)},null,512),[[v,t.orgDetails.subOrganisationCode]])])]),e("div",re,[e("div",ce,[u(e("input",{class:"form-control",readonly:"",type:"hidden","onUpdate:modelValue":s[4]||(s[4]=o=>t.customerDetails.customerCode=o)},null,512),[[v,t.customerDetails.customerCode]])])])]),e("div",de,[e("div",ue,[t.errors.length?(a(),n("div",me,[he,e("ul",null,[(a(!0),n(h,null,p(t.errors,o=>(a(),n("li",null,l(o),1))),256))])])):C("",!0),t.message.length?(a(),n("div",_e,[(a(!0),n(h,null,p(t.message,o=>(a(),n("strong",null,l(o),1))),256))])):C("",!0),e("table",ve,[pe,(a(!0),n(h,null,p(t.items,o=>(a(),n("tbody",{key:o},[e("tr",null,[e("td",null,[u((a(),n("select",{"onUpdate:modelValue":r=>o.itemCode=r,class:"form-control",onChange:s[5]||(s[5]=r=>m.onChange(r)),key:o},[fe,(a(!0),n(h,null,p(t.allitem,r=>(a(),n("option",{value:r.itemOrgCode},l(r.itemCode)+" - PRICE: "+l(r.price),9,be))),256))],40,ge)),[[g,o.itemCode]])]),e("td",null,[u((a(),n("input",{class:"form-control",type:"number","onUpdate:modelValue":r=>o.quantity=r,onKeyup:r=>m.calculateLineTotal(o),key:o},null,40,ye)),[[v,o.quantity]])]),e("td",null,[e("p",null,l(o.line_total),1)]),e("td",null,[e("span",{class:"btn btn-danger btn-sm",style:{margin:"5px 0 0 0"},onClick:r=>m.deleteRow(i.k,o)},De,8,Ce)])])]))),128))])])]),ke,e("div",Ie,[e("div",ze,[Ne,e("div",Ve,[e("div",Se,[e("div",null,[e("p",Ae,[Be,e("strong",null,l(t.invoicesubtotal),1)])]),e("div",null,[e("p",Te,[Ue,e("strong",null,l(this.allitems.taxType),1)])]),e("div",Oe,[e("p",we,[Fe,e("strong",null,l(t.invoicetotal),1)])]),qe])])])])])],32)])])]),Le])]),f(x)],64)}var je=k(N,[["render",Pe]]);const Ee={__name:"CreateUserInvoiceView",setup(i){return(s,c)=>(a(),n("main",null,[f(D),f(je)]))}};export{Ee as default};
