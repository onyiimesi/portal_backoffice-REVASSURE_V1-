import{H as N}from"./Header.61007050.js";import{_ as I,a as u,u as w,o as a,c as n,b as t,t as i,d as f,w as S,l as V,s as b,n as h,q as C,v as p,F as v,k as g,e as D,f as c,h as y,r as x}from"./index.a5d27921.js";const B={name:"customeruserinvoice",data(){return{errors:[],message:[],allitem:[],allitems:[],invoicesubtotal:0,invoicetotal:0,invoicetax:0,tax:[],price:[],allorg:[],allsub:[],allcurrency:[],customerDetails:{customerCode:"",fullNames:"",id:"",fullNames:""},orgDetails:{emailAddress:"",subOrganisationCode:"",organizationCode:"",firstName:"",lastName:"",middleName:"",gender:"",unit:""},organizationCode:"",subOrganizationCode:"",customerCode:"",currencyCode:"",itemList:[],items:[{itemCode:"",quantity:"",line_total:0}],role:"",loaderDiv:"",mainDiv:"d-none",prices:"",selectedCurrency:"NGN",roles:"billing-oficer"}},async mounted(){this.role=localStorage.getItem("role"),this.roles!=this.role&&(localStorage.removeItem("token"),this.$router.push("/"));const l=await u.get("api/Users/profile",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.orgDetails=l.data.result;const e=await u.get("api/Customer/details/"+this.$route.params.id,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.customerDetails=e.data.result,this.loaderDiv="d-none",this.mainDiv="";const d=await u.get("api/Currency/allcurrencies",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allcurrency=d.data.result;const _=await u.get("api/Item/organizations/"+this.orgDetails.organizationCode,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allitem=_.data.result,this.prices=_.data.result.price;const s=await u.get("api/Organisation/details/"+this.orgDetails.organizationCode,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allorg=s.data.result},methods:{calculateTotal(){var l,e;l=this.items.reduce(function(d,_){var s=parseFloat(_.line_total);if(!isNaN(s))return d+s},0),this.invoicesubtotal=l.toFixed(2),e=l*(this.allitems.taxType/100)+l,e=parseFloat(e),isNaN(e)?this.invoicetotal="0.00":this.invoicetotal=e.toFixed(2)},calculateLineTotal(l){var e=parseFloat(this.allitems.price)*parseFloat(l.quantity);isNaN(e)||(l.line_total=e.toFixed(2)),this.calculateTotal()},deleteRow(l,e){var d=this.items.indexOf(e);d>-1&&this.items.splice(d,1),this.calculateTotal()},async onChange(l){const e=await u.get("api/Item/details/"+l.target.value,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allitems=e.data.result.itemDetails,this.items.push({itemCode:"",quantity:"",line_total:0})},async createInvoice(){this.errors=[],this.message=[];const l=w();this.currencyCode?(this.itemList.push(this.items),await u.post("api/Invoice/addinvoice",{organizationCode:this.orgDetails.organizationCode,SubOrganizationCode:this.orgDetails.subOrganisationCode,customerCode:this.customerDetails.customerCode,currencyCode:this.currencyCode,items:this.items},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>{l.success(e.data.message),this.currencyCode="",this.items=[{itemCode:"",quantity:"",line_total:0}],this.invoicesubtotal="",this.invoicetotal="",this.allitems=""}).catch(e=>{e.response.data.title&&l.error("Please fill in all the fields")})):l.error("Please choose a currency")}}},T={id:"layout-wrapper"},A={class:"main-content"},O={class:"page-content"},U={class:"container-fluid"},F={class:"row"},q={class:"col-12"},P={class:"page-title-box d-flex align-items-center justify-content-between"},L={class:"mb-0"},H=c("Create Customer Bill "),M=t("br",null,null,-1),R=c(),E={style:{"font-size":"14px","font-weight":"500"}},G=c(),K={style:{"font-size":"14px","font-weight":"500"}},j={class:"page-title-right"},Q={class:"breadcrumb m-0"},J={class:"breadcrumb-item"},W=c("Home"),X=t("li",{class:"breadcrumb-item active"},"Create Customer Bill",-1),Y={class:"row"},Z={class:"col-lg-12"},$={class:"row"},tt={class:"col-md-6 m-0 p-0"},et={class:"bg-white p-4 h-100"},st=y('<div class="ph-item"><div class="ph-col-12"><div class="ph-row"><div class="ph-col-4"></div><div class="ph-col-8 empty"></div><div class="ph-col-6"></div><div class="ph-col-6 empty"></div><div class="ph-col-12"></div><div class="ph-col-12"></div><div class="ph-col-12"></div><div class="ph-col-12"></div></div><div class="ph-row"><div class="ph-col-4"></div><div class="ph-col-8 empty"></div><div class="ph-col-6"></div><div class="ph-col-6 empty"></div><div class="ph-col-12"></div></div></div></div>',1),ot=[st],it={class:""},lt={class:"mb-4"},at={class:"mb-3"},nt={style:{"font-size":"18px"}},rt={class:"mb-3"},ct={style:{"font-size":"18px"}},dt={class:"mb-3"},ut={style:{"font-size":"18px"}},ht={class:"col-md-6 p-0"},_t={class:"bg-white p-4"},mt={class:""},vt=y('<div class="form-group"><label for="">Invoice Date</label><input type="date" class="form-control"></div><div class="form-group"><label for="">Due Date</label><input type="date" class="form-control"></div>',2),pt={class:"form-group"},gt=t("label",{class:"control-label"},[c("Currency "),t("span",{class:"text-danger"},"*")],-1),ft=["value"],yt=["value"],bt=["value"],Ct={class:"bg-white p-4 mb-4 w-100"},Dt={class:""},xt={class:""},zt={class:""},kt={class:"col-md-12"},Nt={class:"form-group"},It={class:""},wt={class:""},St={class:"row"},Vt={class:"col-md-12"},Bt={key:0,class:"alert alert-danger"},Tt=t("b",null,"Please correct the following error(s):",-1),At={key:1,class:"alert alert-success"},Ot={class:"table table-bordered text-center"},Ut=t("thead",{class:"bg-dark text-white"},[t("td",null,[c("Item Name & Price "),t("span",{class:"text-danger"},"*")]),t("td",null,[c("Quantity "),t("span",{class:"text-danger"},"*")]),t("td",null,"Amount"),t("td")],-1),Ft=["onUpdate:modelValue"],qt=["value"],Pt=["onUpdate:modelValue","onKeyup"],Lt=["onClick"],Ht=t("i",{class:"fa fa-times"},null,-1),Mt=[Ht],Rt=t("hr",null,null,-1),Et={class:"card-body"},Gt={class:"row"},Kt=t("div",{class:"col-md-6"},null,-1),jt={class:"col-md-6"},Qt={class:"text-right"},Jt={style:{"font-size":"16px"}},Wt=c("Subtotal: "),Xt={style:{"font-size":"16px"}},Yt=c("VAT: "),Zt={class:"mt-4"},$t={style:{"font-size":"16px"}},te=c("Grand Total: "),ee=t("button",{class:"btn btn-outline-success mt-3"},"Submit",-1),se=y('<footer class="footer"><div class="container-fluid"><div class="row"><div class="col-sm-6"> BackOffice 0.1 \xA9 2022 </div><div class="col-sm-6"><div class="text-sm-right d-none d-sm-block"> Powered by Intelligence </div></div></div></div></footer>',1);function oe(l,e,d,_,s,m){const z=x("router-link"),k=x("router-view");return a(),n(v,null,[t("div",T,[t("div",A,[t("div",O,[t("div",U,[t("div",F,[t("div",q,[t("div",P,[t("h4",L,[H,M,R,t("span",E,i(s.orgDetails.organizationCode)+" // "+i(s.orgDetails.subOrganisationCode)+" //",1),G,t("span",K,i(s.orgDetails.lastName)+" "+i(s.orgDetails.firstName)+" // "+i(this.role),1)]),t("div",j,[t("ol",Q,[t("li",J,[f(z,{to:"/dashboard"},{default:S(()=>[W]),_:1})]),X])])])])]),t("div",Y,[t("form",{onSubmit:e[5]||(e[5]=V((...o)=>m.createInvoice&&m.createInvoice(...o),["prevent"])),class:"w-100"},[t("div",Z,[t("div",$,[t("div",tt,[t("div",et,[t("div",{class:b(this.loaderDiv)},ot,2),t("div",{class:b(this.mainDiv)},[t("div",it,[t("div",lt,[t("h3",null,i(s.customerDetails.firstname)+" "+i(s.customerDetails.lastname),1)]),t("div",at,[t("p",nt,i(s.customerDetails.contactAddress),1)]),t("div",rt,[t("p",ct,i(s.customerDetails.customerCode),1)]),t("div",dt,[t("p",ut,i(s.customerDetails.mobileNumber1)+" - "+i(s.customerDetails.emailAddress),1)])])],2)])]),t("div",ht,[t("div",_t,[t("div",mt,[vt,t("div",pt,[gt,h(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.currencyCode=o),class:"form-control"},[t("option",{value:this.allcurrency[0]},i(this.allcurrency[0]),9,ft),t("option",{value:this.allcurrency[1]},i(this.allcurrency[1]),9,yt),t("option",{value:this.allcurrency[2]},i(this.allcurrency[2]),9,bt)],512),[[C,s.currencyCode]])])])])])])]),t("div",Ct,[t("div",Dt,[t("div",xt,[t("div",zt,[h(t("input",{class:"form-control",readonly:"",type:"hidden","onUpdate:modelValue":e[1]||(e[1]=o=>s.orgDetails.organizationCode=o)},null,512),[[p,s.orgDetails.organizationCode]])])]),t("div",kt,[t("div",Nt,[h(t("input",{class:"form-control",readonly:"",type:"hidden","onUpdate:modelValue":e[2]||(e[2]=o=>s.orgDetails.subOrganisationCode=o)},null,512),[[p,s.orgDetails.subOrganisationCode]])])]),t("div",It,[t("div",wt,[h(t("input",{class:"form-control",readonly:"",type:"hidden","onUpdate:modelValue":e[3]||(e[3]=o=>s.customerDetails.customerCode=o)},null,512),[[p,s.customerDetails.customerCode]])])])]),t("div",St,[t("div",Vt,[s.errors.length?(a(),n("div",Bt,[Tt,t("ul",null,[(a(!0),n(v,null,g(s.errors,o=>(a(),n("li",null,i(o),1))),256))])])):D("",!0),s.message.length?(a(),n("div",At,[(a(!0),n(v,null,g(s.message,o=>(a(),n("strong",null,i(o),1))),256))])):D("",!0),t("table",Ot,[Ut,(a(!0),n(v,null,g(s.items,o=>(a(),n("tbody",{key:o},[t("tr",null,[t("td",null,[h((a(),n("select",{"onUpdate:modelValue":r=>o.itemCode=r,class:"form-control",onChange:e[4]||(e[4]=r=>m.onChange(r)),key:o},[(a(!0),n(v,null,g(s.allitem,r=>(a(),n("option",{value:r.itemOrgCode},i(r.itemCode)+" - PRICE: "+i(r.price),9,qt))),256))],40,Ft)),[[C,o.itemCode]])]),t("td",null,[h((a(),n("input",{class:"form-control",type:"number","onUpdate:modelValue":r=>o.quantity=r,onKeyup:r=>m.calculateLineTotal(o),key:o},null,40,Pt)),[[p,o.quantity]])]),t("td",null,[t("p",null,i(o.line_total),1)]),t("td",null,[t("span",{class:"btn btn-danger btn-sm",style:{margin:"5px 0 0 0"},onClick:r=>m.deleteRow(l.k,o)},Mt,8,Lt)])])]))),128))])])]),Rt,t("div",Et,[t("div",Gt,[Kt,t("div",jt,[t("div",Qt,[t("div",null,[t("p",Jt,[Wt,t("strong",null,i(s.invoicesubtotal),1)])]),t("div",null,[t("p",Xt,[Yt,t("strong",null,i(this.allitems.taxType),1)])]),t("div",Zt,[t("p",$t,[te,t("strong",null,i(s.invoicetotal),1)])]),ee])])])])])],32)])])]),se])]),f(k)],64)}var ie=I(B,[["render",oe]]);const ne={__name:"CreateUserInvoiceView",setup(l){return(e,d)=>(a(),n("main",null,[f(N),f(ie)]))}};export{ne as default};
