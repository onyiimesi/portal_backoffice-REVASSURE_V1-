import{H as y}from"./Header.47845ea9.js";import{_ as w,a as r,u as x,o as d,c as u,b as t,t as s,d as m,w as C,F as h,j as I,e as k,k as N,l as v,v as b,f as c,g as V,r as g}from"./index.e2874b00.js";const D={name:"invoices",data(){return{errors:[],message:[],allinvoice:{organisationCode:"",subOrganisationCode:"",customerCode:"",organisationName:"",subOrganisationName:""},customer:{customerCode:""},invoice:{id:"",invoiceCode:"",invoiceDate:""},items:{amount:""},role:"",roles:[],workflow:[],entryValue:"",comment:"",customerDetails:{id:"",emailAddress:"",subOrganisationCode:"",organizationCode:"",firstName:"",lastName:"",middleName:"",gender:"",unit:""},comment:"",entryValue:""}},async mounted(){this.role=localStorage.getItem("role");const i=await r.get("api/Users/profile",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.customerDetails=i.data.result;const o=await r.get("api/roles/allroles",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.roles=o.data.result;const n=await r.get("api/WorkFlowItem/Items/"+this.customerDetails.organizationCode,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.workflow=n.data.result,await r.get("api/Invoice/details/"+this.$route.params.invoiceCode,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(l=>{this.allinvoice=l.data.result.organisation,this.allinvoice=l.data.result.subOrganisation,this.customer=l.data.result.customer,this.invoice=l.data.result.invoice,this.items=l.data.result.items}).catch(l=>{console.log(l)})},computed:{total:function(){let i=[];return Object.entries(this.items).forEach(([o,n])=>{i.push(n.amount)}),i.reduce(function(o,n){return o+n},0)},tax:function(){let i=[];return Object.entries(this.items).forEach(([o,n])=>{i.push(n.tax)}),i.reduce(function(o,n){return o+n},0)}},methods:{async invoiceRebate(){const i=x();if(this.comment||i.error("comment required."),!this.entryValue)i.error("Entry Value required.");else{const o=await r.put("api/Invoice/addrebate",{initiator:0,workFlowEntryItemID:0,reference:this.invoice.invoiceCode,comment:this.comment,entryValue:this.entryValue},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});o?(i.success(o.data.message),this.initiator="",this.workFlowEntryItemID="",this.comment="",this.entryValue=""):i.error("Incorrect Parameter")}}}},A={id:"layout-wrapper"},S={class:"main-content"},B={class:"page-content"},z={class:"container-fluid"},E={class:"row"},O={class:"col-12"},T={class:"page-title-box d-flex align-items-center justify-content-between"},F={class:"mb-0"},L=c("Bill "),P=t("br",null,null,-1),R=c(),M={style:{"font-size":"14px","font-weight":"500"}},j=c(),U={style:{"font-size":"14px","font-weight":"500"}},q={class:"page-title-right"},H={class:"breadcrumb m-0"},G={class:"breadcrumb-item"},Q=c("Home"),W=t("li",{class:"breadcrumb-item active"},"Bill",-1),J={class:"row aa mb-5"},K={class:"col-12"},X={class:"cards"},Y={class:"card-body table-responsive"},Z={class:"brand-section"},$={class:"row"},tt={class:"col-6"},et={class:"text-dark"},st={class:"text-dark"},ot={class:"col-6"},it={class:"company-details"},nt={class:"heading"},at={class:"sub-heading"},lt={class:"body-section"},ct={class:"row"},rt={class:"col-6"},dt=t("h4",null,"Invoice To:",-1),ut={class:"sub-heading"},_t={class:"sub-heading"},mt={class:"col-6"},ht=t("h4",null,"Bill To:",-1),vt={class:"sub-heading"},bt=c("Full Name: "),gt={class:"sub-heading"},pt=c("Email Address: "),ft={class:"sub-heading"},yt=c("Phone Number: "),wt={class:"sub-heading"},xt=c("LGA,State: "),Ct={class:"body-section"},It={class:"text-center"},kt=t("thead",null,[t("tr",null,[t("th",null,"ITEM"),t("th",{class:"w-20"},"Price"),t("th",{class:"w-20"},"Quantity"),t("th",{class:"w-20"},"Amount")])],-1),Nt=t("td",{colspan:"3",class:"text-right"},"Tax Total",-1),Vt=t("td",{colspan:"3",class:"text-right"},"Grand Total",-1),Dt=t("br",null,null,-1),At={class:"heading"},St={key:0,class:"btn btn-info mt-3","data-toggle":"modal","data-target":"#bs-example-modal-lg"},Bt={class:"modal fade",id:"bs-example-modal-lg",tabindex:"-1",role:"dialog","aria-labelledby":"myLargeModalLabel","aria-hidden":"true"},zt={class:"modal-dialog modal-dialog-centered"},Et={class:"modal-content"},Ot=t("div",{class:"modal-header"},[t("h5",{id:"myLargeModalLabel",class:"modal-title mt-0"},"Apply Rebate"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"\xD7")])],-1),Tt={class:"modal-body"},Ft={class:"row"},Lt={class:"col-md-12 mb-4"},Pt={class:"form-group"},Rt=t("label",{class:"control-label"},"Entry Value",-1),Mt={class:"col-md-12 mb-4"},jt={class:"form-group"},Ut=t("label",{class:"control-label"},"Comment",-1),qt=t("div",{class:"col"},[t("button",{type:"submit",class:"btn btn-success float-left"},"Apply Rebate"),t("button",{type:"button",class:"btn btn-danger float-right","data-dismiss":"modal"},"Close")],-1),Ht=t("hr",null,null,-1),Gt=V('<footer class="footer"><div class="container-fluid"><div class="row"><div class="col-sm-6"> BackOffice 0.1 \xA9 2022 </div><div class="col-sm-6"><div class="text-sm-right d-none d-sm-block"> Powered by Intelligence </div></div></div></div></footer>',1);function Qt(i,o,n,l,e,_){const p=g("router-link"),f=g("router-view");return d(),u(h,null,[t("div",A,[t("div",S,[t("div",B,[t("div",z,[t("div",E,[t("div",O,[t("div",T,[t("h4",F,[L,P,R,t("span",M,s(e.customerDetails.organizationCode)+" // "+s(e.customerDetails.subOrganisationCode)+" //",1),j,t("span",U,s(e.customerDetails.lastName)+" "+s(e.customerDetails.firstName)+" // "+s(this.role),1)]),t("div",q,[t("ol",H,[t("li",G,[m(p,{to:"/dashboard"},{default:C(()=>[Q]),_:1})]),W])])])])]),t("div",J,[t("div",K,[t("div",X,[t("div",Y,[t("div",Z,[t("div",$,[t("div",tt,[t("h1",et,s(e.allinvoice.organisationName),1),t("h3",st,s(e.allinvoice.subOrganisationName),1)]),t("div",ot,[t("div",it,[t("h2",nt,"Invoice #"+s(e.invoice.invoiceCode),1),t("p",at,"Invoice Date: "+s(e.invoice.invoiceDate),1)])])])]),t("div",lt,[t("div",ct,[t("div",rt,[dt,t("p",ut,"Customer Code: "+s(e.invoice.customerCode),1),t("p",_t,"Curency Code: "+s(e.invoice.currencyCode),1)]),t("div",mt,[ht,t("p",vt,[bt,t("strong",null,s(e.customer.firstname)+" "+s(e.customer.lastname),1)]),t("p",gt,[pt,t("strong",null,s(e.customer.emailAddress),1)]),t("p",ft,[yt,t("strong",null,s(e.customer.mobileNumber1)+", "+s(e.customer.mobileNumber2),1)]),t("p",wt,[xt,t("strong",null,s(e.customer.lgaCode)+", "+s(e.customer.stateCode),1)])])])]),t("div",Ct,[t("table",It,[kt,t("tbody",null,[(d(!0),u(h,null,I(e.items,a=>(d(),u("tr",null,[t("td",null,s(a.itemName),1),t("td",null,s(a.price),1),t("td",null,s(a.quantity),1),t("td",null,s(a.amount),1)]))),256)),t("tr",null,[Nt,t("td",null,s(_.tax),1)]),t("tr",null,[Vt,t("td",null,s(_.total),1)])])]),Dt,t("h3",At,"Payment Status: "+s(e.invoice.paymentStatus),1)])])]),e.role==="billing-oficer"&&e.invoice.paymentStatus=="UNPAID"?(d(),u("button",St,"Apply Rebate")):k("",!0),t("div",Bt,[t("div",zt,[t("div",Et,[Ot,t("div",Tt,[t("form",{onSubmit:o[2]||(o[2]=N((...a)=>_.invoiceRebate&&_.invoiceRebate(...a),["prevent"]))},[t("div",Ft,[t("div",Lt,[t("div",Pt,[Rt,v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=a=>e.entryValue=a)},null,512),[[b,e.entryValue]])])]),t("div",Mt,[t("div",jt,[Ut,v(t("textarea",{"onUpdate:modelValue":o[1]||(o[1]=a=>e.comment=a),class:"form-control",id:"",cols:"30",rows:"10"},null,512),[[b,e.comment]])])]),qt]),Ht],32)])])])])])])])]),Gt])]),m(f)],64)}var Wt=w(D,[["render",Qt]]);const Xt={__name:"InvoiceView",setup(i){return(o,n)=>(d(),u("main",null,[m(y),m(Wt)]))}};export{Xt as default};
