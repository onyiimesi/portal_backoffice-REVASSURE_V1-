import{H as O}from"./Header.61007050.js";import{_ as N,a as _,u as k,o as a,c as n,b as t,t as e,d as r,w as c,l as A,n as b,v as D,q as x,F as h,k as g,e as v,s as m,f as u,h as w,r as f}from"./index.a5d27921.js";const z={name:"listorganization",data(){return{name:"",allorg:[],allorgs:[],search:"",showsearch:!1,caris:[],showpar:!1,role:"",roles:"0",roless:"portal-admin",parentOrganizationCode:"",customerDetails:{emailAddress:"",subOrganisationCode:"",organizationCode:"",firstName:"",lastName:"",middleName:"",gender:"",unit:""},loaderDiv:"",mainDiv:"d-none"}},async mounted(){this.role=localStorage.getItem("role"),this.roles!=this.role&&this.roless!=this.role&&(localStorage.removeItem("token"),this.$router.push("/"));const i=await _.get("api/Users/profile",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.customerDetails=i.data.result;const o=await _.get("api/Organisation/organizations",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allorg=o.data.result,this.loaderDiv="d-none",this.mainDiv="",this.showpar=!1,this.showsearch=!1,$("#datatable").dataTable().fnDestroy(),setTimeout(()=>{$("#datatable").DataTable({lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"All"]],pageLength:25,bFilter:!1,retrieve:!0}).clear()})},methods:{async onChange(i){const o=await _.get("api/Organisation/organizations/"+i.target.value,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allorgs=o.data.result,this.showpar=!0,this.showsearch=!1},async searchOrg(){const i=k();await _.get("api/Organisation/search?search="+this.search,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(o=>{this.caris=o.data.result,this.caris.length==0&&i.error("You can only search by organisation name or organisation code"),setTimeout(()=>{$("#datatable").DataTable({lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"All"]],pageLength:25,retrieve:!0})}),this.search="",this.showsearch=!0}).catch(o=>{this.eee=o.response.data.errors,i.error(this.eee.search[0])})}}},S={id:"layout-wrapper"},V={class:"main-content"},B={class:"page-content"},P={class:"container-fluid"},E={class:"row"},T={class:"col-12"},I={class:"page-title-box d-flex align-items-center justify-content-between"},L={class:"mb-0"},M=u("Organisations "),W=t("br",null,null,-1),F=u(),H={style:{"font-size":"14px","font-weight":"500"}},U=u(" // "),G={style:{"font-size":"14px","font-weight":"500"}},j={class:"page-title-right"},q={class:"breadcrumb m-0"},Y={class:"breadcrumb-item"},J=u("Home"),K=t("li",{class:"breadcrumb-item active"},"Organisations",-1),Q={class:"row"},R={class:"col-12"},X={class:"card"},Z={class:"card-body"},tt=t("h5",null,"Search Organisation",-1),st=t("hr",null,null,-1),et={class:"row"},ot={class:"col-md-4"},at=t("button",{class:"btn btn-outline-success"},"Search",-1),nt={class:"card"},lt={class:"card-body table-responsive"},it={class:"mb-4"},rt={class:"row"},dt={class:"col-md-12"},ct={class:"mb-2 float-left"},ht=t("label",{for:""},"Choose Parent Organisation",-1),ut=["value"],_t={key:0,class:"mt-3 float-right"},gt=t("button",{class:"btn btn-outline-success"},[t("i",{class:"fa fa-plus"}),u(" Create Organisation")],-1),vt={key:0},pt={class:"table table-bordered dt-responsive nowrap",style:{"border-collapse":"collapse","border-spacing":"0",width:"100%"}},bt=t("thead",null,[t("tr",null,[t("th",null,"Parent Code"),t("th",null,"Organisation Code"),t("th",null,"Organisation Name"),t("th",null,"Email Address"),t("th",null,"Phone Number"),t("th",null,"Address"),t("th",null,"Website"),t("th",null,"Action")])],-1),mt=t("button",{type:"button",class:"btn btn-outline-success"},"View",-1),ft=t("a",{href:"/list-organisation"},[t("button",{class:"btn btn-outline-success"},"Go Back")],-1),wt={key:1},yt={class:"table table-bordered dt-responsive nowrap",style:{"border-collapse":"collapse","border-spacing":"0",width:"100%"}},Ct=t("thead",null,[t("tr",null,[t("th",null,"Parent Code"),t("th",null,"Organisation Code"),t("th",null,"Organisation Name"),t("th",null,"Email Address"),t("th",null,"Phone Number"),t("th",null,"Address"),t("th",null,"Website"),t("th",null,"Action")])],-1),Ot=t("button",{type:"button",class:"btn btn-outline-success"},"View",-1),Nt=t("a",{href:"/list-organisation"},[t("button",{class:"btn btn-outline-success"},"Go Back")],-1),kt={key:2},At=w('<div class="ph-item"><div class="ph-col-12"><div class="ph-row"><div class="ph-col-4"></div><div class="ph-col-8 empty"></div><div class="ph-col-6"></div><div class="ph-col-6 empty"></div><div class="ph-col-12"></div><div class="ph-col-12"></div><div class="ph-col-12"></div><div class="ph-col-12"></div></div><div class="ph-row"><div class="ph-col-4"></div><div class="ph-col-8 empty"></div><div class="ph-col-6"></div><div class="ph-col-6 empty"></div><div class="ph-col-12"></div><div class="ph-col-12"></div><div class="ph-col-12"></div><div class="ph-col-12"></div></div></div></div>',1),Dt=[At],xt={id:"datatable",class:"table table-border-success table-bordered dt-responsive nowrap",style:{"border-collapse":"collapse","border-spacing":"0",width:"100%"}},zt=t("thead",null,[t("tr",null,[t("th",null,"Parent Code"),t("th",null,"Organisation Code"),t("th",null,"Organisation Name"),t("th",null,"Email Address"),t("th",null,"Action")])],-1),St=t("div",null,null,-1),Vt=t("button",{type:"button",class:"btn btn-outline-success"},"View",-1),Bt=w('<footer class="footer"><div class="container-fluid"><div class="row"><div class="col-sm-6"> BackOffice 0.1 \xA9 2022 </div><div class="col-sm-6"><div class="text-sm-right d-none d-sm-block"> Powered by Intelligence </div></div></div></div></footer>',1);function Pt(i,o,y,Tt,l,p){const d=f("router-link"),C=f("router-view");return a(),n(h,null,[t("div",S,[t("div",V,[t("div",B,[t("div",P,[t("div",E,[t("div",T,[t("div",I,[t("h4",L,[M,W,F,t("span",H,e(l.customerDetails.organizationCode)+" // "+e(l.customerDetails.subOrganisationCode),1),U,t("span",G,e(l.customerDetails.lastName)+" "+e(l.customerDetails.firstName)+" // "+e(this.role),1)]),t("div",j,[t("ol",q,[t("li",Y,[r(d,{to:"/dashboard"},{default:c(()=>[J]),_:1})]),K])])])])]),t("div",Q,[t("div",R,[t("div",X,[t("div",Z,[tt,st,t("form",{onSubmit:o[1]||(o[1]=A((...s)=>p.searchOrg&&p.searchOrg(...s),["prevent"]))},[t("div",et,[t("div",ot,[b(t("input",{class:"form-control mb-3",type:"text",placeholder:"Enter Organisation code or Organisation name","onUpdate:modelValue":o[0]||(o[0]=s=>l.search=s)},null,512),[[D,l.search]]),at])])],32)])]),t("div",nt,[t("div",lt,[t("div",it,[t("form",null,[t("div",rt,[t("div",dt,[t("div",ct,[ht,b(t("select",{onChange:o[2]||(o[2]=s=>p.onChange(s)),"onUpdate:modelValue":o[3]||(o[3]=s=>i.organisationCode=s),class:"form-control",style:{width:"200px"}},[(a(!0),n(h,null,g(l.allorg,s=>(a(),n("option",{value:s.organisationCode},e(s.organisationCode),9,ut))),256))],544),[[x,i.organisationCode]])]),l.role==="0"||l.role==="portal-admin"?(a(),n("div",_t,[r(d,{to:"/create-organization"},{default:c(()=>[gt]),_:1})])):v("",!0)])])])]),this.showsearch==!0?(a(),n("div",vt,[t("table",pt,[bt,t("tbody",null,[(a(!0),n(h,null,g(l.caris,s=>(a(),n("tr",null,[t("td",null,e(s.parentOrganisationCode),1),t("td",null,e(s.organisationCode),1),t("td",null,e(s.organisationName),1),t("td",null,e(s.organisationEmail),1),t("td",null,e(s.organisationPhoneNumber),1),t("td",null,e(s.organisationAddress),1),t("td",null,e(s.organisationWebsite),1),t("td",null,[r(d,{to:"/view-organisation/"+s.organisationCode},{default:c(()=>[mt]),_:2},1032,["to"])])]))),256))])]),ft])):v("",!0),this.showpar==!0&&this.showsearch==!1?(a(),n("div",wt,[t("table",yt,[Ct,t("tbody",null,[(a(!0),n(h,null,g(l.allorgs,s=>(a(),n("tr",null,[t("td",null,e(s.parentOrganisationCode),1),t("td",null,e(s.organisationCode),1),t("td",null,e(s.organisationName),1),t("td",null,e(s.organisationEmail),1),t("td",null,e(s.organisationPhoneNumber),1),t("td",null,e(s.organisationAddress),1),t("td",null,e(s.organisationWebsite),1),t("td",null,[r(d,{to:"/view-organisation/"+s.organisationCode},{default:c(()=>[Ot]),_:2},1032,["to"])])]))),256))])]),Nt])):v("",!0),this.showpar==!1&&this.showsearch==!1?(a(),n("div",kt,[t("div",{class:m(this.loaderDiv)},Dt,2),t("div",{class:m(this.mainDiv)},[t("table",xt,[zt,t("tbody",null,[St,(a(!0),n(h,null,g(l.allorg,s=>(a(),n("tr",null,[t("td",null,e(s.parentOrganisationCode),1),t("td",null,e(s.organisationCode),1),t("td",null,e(s.organisationName),1),t("td",null,e(s.organisationEmail),1),t("td",null,[r(d,{to:"/view-organisation/"+s.organisationCode},{default:c(()=>[Vt]),_:2},1032,["to"])])]))),256))])])],2)])):v("",!0)])])])])])]),Bt])]),r(C)],64)}var Et=N(z,[["render",Pt]]);const Mt={__name:"ListOrgView",setup(i){return(o,y)=>(a(),n("main",null,[r(O),r(Et)]))}};export{Mt as default};
