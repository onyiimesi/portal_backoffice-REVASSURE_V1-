import{H as U}from"./Header.61007050.js";import{_ as y,a as c,u as z,o as a,c as l,b as s,t as n,d as h,w as A,F as u,k as _,e as b,l as k,n as d,q as g,v as m,f as i,h as S,r as w}from"./index.a5d27921.js";import{u as V,r as N,s as O}from"./index.esm.0e85bd27.js";const D={name:"setupusers",data(){return{v$:V(),errors:[],error:!1,message:[],allroles:[],allsub:[],allsuborg:[],emailAddress:"",subOrganisationCode:"",organizationCode:"",unit:"",firstName:"",lastName:"",middleName:"",gender:"",password:"",confirmPassword:"",role:"",roles:"",customerDetails:{emailAddress:"",subOrganisationCode:"",organizationCode:"",firstName:"",lastName:"",middleName:"",gender:"",unit:""},role:"org-admin"}},validations(){return{password:{required:N},confirmPassword:{required:N,sameAsPassword:O(this.password)}}},async mounted(){this.roles=localStorage.getItem("role"),this.role!=this.roles&&(localStorage.removeItem("token"),this.$router.push("/"));const r=await c.get("api/Users/profile",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.customerDetails=r.data.result;const o=await c.get("api/Item/organizations/"+this.customerDetails.organizationCode,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allitems=o.data.result;const p=await c.get("api/roles/allroles",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allroles=p.data.result;const f=await c.get("api/SubOrganisation/suborganizations/"+this.customerDetails.organizationCode,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allsuborg=f.data.result},methods:{async onChange(r){const o=await c.get("api/SubOrganisation/suborganizations/"+r.target.value,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.allsub=o.data.result},async handleUser(){this.errors=[],this.message=[];const r=z();if(this.emailAddress||r.error("Email Address required."),this.subOrganisationCode||r.error("Unit required."),this.firstName||r.error("Firstname required."),this.lastName||r.error("Lastname required."),this.gender||r.error("Gender required."),this.role||r.error("Role required."),this.v$.$validate(),this.v$.$error)r.error("Password & Confirm Password Don't Match.");else{const o=await c.post("api/Users/adduser",{emailAddress:this.emailAddress,subOrganisationCode:this.subOrganisationCode,organizationCode:this.customerDetails.organizationCode,unit:this.unit,firstName:this.firstName,lastName:this.lastName,middleName:this.middleName,gender:this.gender,password:this.password,role:this.role},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});o?(r.success(o.data.message),this.$router.push("/view-users"),this.emailAddress="",this.subOrganisationCode="",this.organizationCode="",this.firstName="",this.lastName="",this.middleName="",this.gender="",this.password="",this.confirmPassword="",this.role=""):r.error("Incorrect Parameter")}}}},P={id:"layout-wrapper"},I={class:"main-content"},B={class:"page-content"},q={class:"container-fluid"},M={class:"row"},F={class:"col-12"},E={class:"page-title-box d-flex align-items-center justify-content-between"},H={class:"mb-0"},L=i("Create User "),T=s("br",null,null,-1),G=i(),R={style:{"font-size":"14px","font-weight":"500"}},j=i(),J={style:{"font-size":"14px","font-weight":"500"}},K={class:"page-title-right"},Q={class:"breadcrumb m-0"},W={class:"breadcrumb-item"},X=i("Home"),Y=s("li",{class:"breadcrumb-item active"},"Create User",-1),Z={class:"row"},$={class:"col-lg-12"},ss={class:"card"},es={class:"card-body"},os={key:0,class:"alert alert-danger"},ts={key:1,class:"alert alert-success"},rs={class:"row pl-4 pr-4 pt-3 pb-3"},as={class:"col-md-12 mb-3"},ls={class:"form-group"},is=s("label",{class:"control-label"},[i("Unit "),s("span",{class:"text-danger"},"*")],-1),ns=["value"],ds={class:"col-md-4 mb-3"},cs={class:"form-group"},ms=s("label",{class:"control-label"},[i("First Name "),s("span",{class:"text-danger"},"*")],-1),us={class:"col-md-4 mb-3"},_s={class:"form-group"},hs=s("label",{class:"control-label"},"Middle Name (optional)",-1),ps={class:"col-md-4 mb-3"},gs={class:"form-group"},fs=s("label",{class:"control-label"},[i("Last Name "),s("span",{class:"text-danger"},"*")],-1),vs={class:"col-md-4 mb-3"},bs={class:"form-group"},ws=s("label",{class:"control-label"},[i("Email Address "),s("span",{class:"text-danger"},"*")],-1),Ns={class:"col-md-4 mb-3"},Cs={class:"form-group"},xs=s("label",{class:"control-label"},[i("Gender "),s("span",{class:"text-danger"},"*")],-1),Us=s("option",{value:"male"},"Male",-1),ys=s("option",{value:"female"},"Female",-1),zs=[Us,ys],As={class:"col-md-4 mb-3"},ks={class:"form-group"},Ss=s("label",{class:"control-label"},[i("Role "),s("span",{class:"text-danger"},"*")],-1),Vs=["value"],Os={class:"col-md-6 mb-3"},Ds={class:"form-group"},Ps=s("label",{class:"control-label"},[i("Password "),s("span",{class:"text-danger"},"*")],-1),Is={class:"col-md-6 mb-3"},Bs={class:"form-group"},qs=s("label",{class:"control-label"},[i("Confirm Password "),s("span",{class:"text-danger"},"*")],-1),Ms=s("button",{class:"btn btn-outline-success ml-4"},"Create User",-1),Fs=S('<footer class="footer"><div class="container-fluid"><div class="row"><div class="col-sm-6"> BackOffice 0.1 \xA9 2022 </div><div class="col-sm-6"><div class="text-sm-right d-none d-sm-block"> Powered by Intelligence </div></div></div></div></footer>',1);function Es(r,o,p,f,t,v){const C=w("router-link"),x=w("router-view");return a(),l(u,null,[s("div",P,[s("div",I,[s("div",B,[s("div",q,[s("div",M,[s("div",F,[s("div",E,[s("h4",H,[L,T,G,s("span",R,n(t.customerDetails.organizationCode)+" // "+n(t.customerDetails.subOrganisationCode)+" //",1),j,s("span",J,n(t.customerDetails.lastName)+" "+n(t.customerDetails.firstName)+" // "+n(this.roles),1)]),s("div",K,[s("ol",Q,[s("li",W,[h(C,{to:"/dashboard"},{default:A(()=>[X]),_:1})]),Y])])])])]),s("div",Z,[s("div",$,[s("div",ss,[s("div",es,[t.errors.length?(a(),l("div",os,[(a(!0),l(u,null,_(t.errors,e=>(a(),l("strong",null,n(e),1))),256))])):b("",!0),t.message.length?(a(),l("div",ts,[(a(!0),l(u,null,_(t.message,e=>(a(),l("strong",null,n(e),1))),256))])):b("",!0),s("form",{onSubmit:o[9]||(o[9]=k((...e)=>v.handleUser&&v.handleUser(...e),["prevent"]))},[s("div",rs,[s("div",as,[s("div",ls,[is,d(s("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>t.subOrganisationCode=e),class:"form-control",id:""},[(a(!0),l(u,null,_(t.allsuborg,e=>(a(),l("option",{value:e.subOrganisationCode},n(e.subOrganisationName),9,ns))),256))],512),[[g,t.subOrganisationCode]])])]),s("div",ds,[s("div",cs,[ms,d(s("input",{class:"form-control",type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>t.firstName=e),autocomplete:"nope"},null,512),[[m,t.firstName]])])]),s("div",us,[s("div",_s,[hs,d(s("input",{class:"form-control",type:"text","onUpdate:modelValue":o[2]||(o[2]=e=>t.middleName=e),autocomplete:"nope"},null,512),[[m,t.middleName]])])]),s("div",ps,[s("div",gs,[fs,d(s("input",{class:"form-control",type:"text","onUpdate:modelValue":o[3]||(o[3]=e=>t.lastName=e),autocomplete:"nope"},null,512),[[m,t.lastName]])])]),s("div",vs,[s("div",bs,[ws,d(s("input",{class:"form-control",type:"text","onUpdate:modelValue":o[4]||(o[4]=e=>t.emailAddress=e),autocomplete:"nope"},null,512),[[m,t.emailAddress]])])]),s("div",Ns,[s("div",Cs,[xs,d(s("select",{"onUpdate:modelValue":o[5]||(o[5]=e=>t.gender=e),class:"form-control",id:""},zs,512),[[g,t.gender]])])]),s("div",As,[s("div",ks,[Ss,d(s("select",{"onUpdate:modelValue":o[6]||(o[6]=e=>t.role=e),class:"form-control",id:""},[(a(!0),l(u,null,_(t.allroles,e=>(a(),l("option",{key:e.rolCode,value:e.rolCode},n(e.rolName),9,Vs))),128))],512),[[g,t.role]])])]),s("div",Os,[s("div",Ds,[Ps,d(s("input",{class:"form-control",type:"password","onUpdate:modelValue":o[7]||(o[7]=e=>t.password=e),autocomplete:"nope"},null,512),[[m,t.password]])])]),s("div",Is,[s("div",Bs,[qs,d(s("input",{class:"form-control",type:"password","onUpdate:modelValue":o[8]||(o[8]=e=>t.confirmPassword=e),autocomplete:"nope"},null,512),[[m,t.confirmPassword]])])])]),Ms],32)])])])])])]),Fs])]),h(x)],64)}var Hs=y(D,[["render",Es]]);const Rs={__name:"SetupUsersView",setup(r){return(o,p)=>(a(),l("main",null,[h(U),h(Hs)]))}};export{Rs as default};
